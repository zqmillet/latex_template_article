\documentclass[punct = banjiao]{ctexart}
% 中文字体采用 ctex 默认配置，调整英文字体配置
\setromanfont{Times New Roman}
\setsansfont{Arial}

% 数学配置
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{mathtools}

% 设置段间距
\setlength{\parskip}{0.5\baselineskip}

% 设置标题格式
\usepackage{titlesec}
\titleformat*{\section}{\bfseries\fontsize{14pt}{14pt}\selectfont}
\titlespacing*{\section}{0pt}{10pt}{6pt}
\titleformat*{\subsection}{\bfseries\fontsize{12pt}{12pt}\selectfont}
\titlespacing*{\subsection}{0pt}{10pt}{6pt}
\titleformat*{\subsubsection}{\bfseries\fontsize{12pt}{12pt}\selectfont}
\titlespacing*{\subsubsection}{0pt}{10pt}{6pt}
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{1}
  
% 配置页面布局
\usepackage{geometry}
\geometry
{
    inner          = 1.1in,
    outer          = 1.1in,
    top            = 1.2in,
    bottom         = 1.2in,
    marginparwidth = 1.3in,
    marginparsep   = 0pt,
    headheight     = 21pt
}

% 段落首行缩进
\usepackage{indentfirst}

% 屏蔽宏包警告
\RequirePackage[]{silence}
\WarningsOff[hyperref]

% 设置书签、超链接等
\usepackage{hyperref}
\hypersetup{
    bookmarks = true,
    colorlinks,
    linkcolor = {black},
    citecolor = {blue!50!black},
    urlcolor  = black,
    bookmarksdepth = 4,
    pdfpagelabels
}

% 设置表格
\usepackage{tabu}
\usepackage{longtable}

% 设置列表格式
\usepackage{enumitem}
\setenumerate[1]{itemsep = 0pt, partopsep = 0pt, parsep = 0pt, topsep = 0pt, label = (\arabic*), leftmargin = \parindent}
\setitemize[1]  {itemsep = 0pt, partopsep = 0pt, parsep = 0pt, topsep = 0pt, leftmargin = 1em}
\setitemize[2]  {itemsep = 0pt, partopsep = 0pt, parsep = 0pt, topsep = 0pt, leftmargin = 1em}
\setdescription {labelindent = 0em, itemsep = 0pt, parsep = 0pt, topsep = 0pt, partopsep = 0pt, labelsep* = 1em, leftmargin = !, style = standard, font = \normalfont}

% 设置页眉页脚
\usepackage{fancyhdr}
\usepackage{lastpage}
\makeatletter
\DeclareDocumentCommand\authorname{m}{
    \gdef\qiqi@authorname{#1}
}
\DeclareDocumentCommand\maintitle{m}{
    \gdef\qiqi@title{#1}
}
\DeclareDocumentCommand\abstract{+m}{
    \long\gdef\qiqi@abstract{#1}
}

\fancypagestyle{plain}{%
    \fancyhf{}
    \fancyhead[L]{}
    \fancyhead[C]{\qiqi@title}
    \fancyhead[R]{\qiqi@authorname{}}
    \fancyfoot[C]{}
    \fancyfoot[R]{第 \thepage{} 页,共 \pageref{LastPage} 页}
    \fancyfoot[L]{\zhtoday}
    \renewcommand{\headrulewidth}{0.4pt}
    \renewcommand{\footrulewidth}{0.4pt}
}

\fancypagestyle{cover}{%
    \fancyhf{}
    \fancyhead[L]{}
    \fancyhead[C]{\qiqi@title}
    \fancyhead[R]{\qiqi@authorname{}}
    \fancyfoot[C]{}
    \fancyfoot[R]{第 \thepage{} 页}
    \fancyfoot[L]{\zhtoday}
    \renewcommand{\headrulewidth}{0.4pt}
    \renewcommand{\footrulewidth}{0.4pt}
}
\makeatother

\usepackage{pifont}
\let\proofname\relax
\usepackage[amsmath, amsthm, thmmarks, hyperref]{ntheorem}
\newcounter{DefinitionCounter}
\numberwithin{DefinitionCounter}{section}
\theoremstyle{plain}
\theoremsymbol{\ding{117}}
\theoremseparator{.}
\newtheorem{Definition}[DefinitionCounter]{定义}
\let\oldDefinition\Definition
\def\Definition{\oldDefinition\normalfont\kaishu}

\newcounter{CriterionCounter}
\numberwithin{CriterionCounter}{section}
\theoremstyle{plain}
\theoremsymbol{\ding{117}}
\theoremseparator{.}
\newtheorem{Criterion}[CriterionCounter]{判据}
\let\oldCriterion\Criterion
\def\Criterion{\oldCriterion\normalfont\itshape}

\newcounter{LemmaCounter}
\numberwithin{LemmaCounter}{section}
\theoremstyle{plain}
\theoremsymbol{\Circle}
\theoremseparator{.}
\newtheorem{Lemma}[LemmaCounter]{引理}
\let\oldLemma\Lemma
\def\Lemma{\oldLemma\normalfont\itshape}

\newcounter{ExampleCounter}
\numberwithin{ExampleCounter}{section}
\theoremstyle{plain}
\theoremsymbol{$\Box$}
\theoremseparator{.}
\newtheorem{Example}[ExampleCounter]{例}
\let\oldExample\Example
\def\Example{\oldExample\normalfont\itshape}

\newcounter{TheoremCounter}
\numberwithin{TheoremCounter}{section}
\theoremstyle{plain}
\theoremsymbol{$\Diamond$}
\theoremseparator{.}
\newtheorem{Theorem}[TheoremCounter]{定理}
\let\oldTheorem\Theorem
\def\Theorem{\oldTheorem\normalfont\itshape}

\newcounter{ProofCounter}
\numberwithin{ProofCounter}{section}
\theoremstyle{plain}
\theoremsymbol{\ding{110}}
\theoremseparator{.}
\newtheorem{Proof}[ProofCounter]{证明}
\let\oldProof\Proof
\def\Proof{\oldProof\normalfont\itshape}


% % 设置图表标题格式
% \usepackage{caption}
% \captionsetup[figure]{
%     font = {small, bf},
%     labelsep = period,
%     textformat = simple,
%     skip = 5pt
% }
% \captionsetup[table]{
%     font = {small, bf},
%     labelsep = period,
%     textformat = simple,
%     skip = 5pt
% }

% 设置封面、摘要和目录
\makeatletter
\AtBeginDocument{
    % page 1
    \pagestyle{empty}
    \pagenumbering{Alph}
    \pdfbookmark[1]{封面}{Cover}
    \begin{centering}
    \rule{0pt}{0pt}\\[100pt]
    {\Huge\bfseries \qiqi@title}\\[70pt]
    {\large\textbf{作者：}\qiqi@authorname}\\\vfill
    {\today}\\
    \end{centering}
    
    % page 2
    \clearpage
    \setcounter{page}{1}
    \renewcommand{\thepage}{\Roman{page}}
    % \pdfbookmark[1]{摘要}{Abstract}
    \addcontentsline{toc}{section}{摘要}
    \section*{摘要}
    \qiqi@abstract
    
    % page 3
    \clearpage
    \setcounter{tocdepth}{4}
    \pdfbookmark[1]{\contentsname}{Contents}
    \tableofcontents
    
    % page 4
    \clearpage
    \pagestyle{plain}
    \setcounter{page}{1}
    \renewcommand{\thepage}{\arabic{page}}
}
\makeatother

% 设置引用格式
\usepackage{cleveref}
\makeatletter
\crefformat{figure}              {图 #2#1#3}
\crefformat{section}             {第 #2#1#3 小节}
\crefformat{table}               {表 #2#1#3}
\crefformat{appendix}            {附录 #2#1#3}
\crefformat{equation}            {公式 #2(#1)#3}
\crefformat{Example}             {例 #2#1#3}
\crefformat{tcb@cnt@codebox}     {代码 #2#1#3}
\crefformat{tcb@cnt@codefilebox} {代码 #2#1#3}
\makeatother

% 设置行间距
\usepackage{setspace}

% 随机产生文本
\usepackage{lipsum}

% 设置行内代码
\usepackage[many, minted]{tcolorbox}
\tcbuselibrary{breakable}
\usepackage{minted}
\usepackage{color}
\makeatletter
\color{black}
\let\default@color\current@color
\def\inlinebox@true{true}
\define@key{inlinebox}{frame rule color} {\def\inlinebox@framerulecolor{#1}}
\define@key{inlinebox}{frame back color} {\def\inlinebox@framebackcolor{#1}}
\define@key{inlinebox}{frame text color} {\def\inlinebox@frametextcolor{#1}}
\define@key{inlinebox}{frame rule width} {\def\inlinebox@framerulewidth{#1}}
\define@key{inlinebox}{banner width}     {\def\inlinebox@bannerwidth{#1}}
\define@key{inlinebox}{show banner}[true]{\def\inlinebox@showbanner{#1}}
\define@key{inlinebox}{banner text color}{\def\inlinebox@bannertextcolor{#1}}
\define@key{inlinebox}{banner back color}{\def\inlinebox@bannerbackcolor{#1}}
\define@key{inlinebox}{banner text}      {\def\inlinebox@bannertext{#1}}
\NewDocumentCommand{\inlinebox}{O{} m}{%
  \setkeys{inlinebox}{%
    frame rule color  = black,
    frame back color  = white,
    frame text color  = black,
    frame rule width  = 0.4pt,
    banner width      = 8pt,
    show banner       = false,
    banner text color = white,
    banner back color = black,
    banner text       = BAN,
    #1
  }%
  \tcbox[%
    enhanced,
    tcbox raise base,
    nobeforeafter,
    boxrule           = \inlinebox@framerulewidth,
    top               = -1pt,
    bottom            = -1pt,
    right             = -1pt,
    arc               = 1pt,
    left              = \ifx\inlinebox@showbanner\inlinebox@true\inlinebox@bannerwidth-2pt\else-1pt\fi,
    colframe          = \inlinebox@framerulecolor,
    coltext           = \inlinebox@frametextcolor,
    colback           = \inlinebox@framebackcolor,
    before upper      = {\vphantom{蛤dg}},
    overlay           = {%
      \begin{tcbclipinterior} \ifx\inlinebox@showbanner\inlinebox@true
          \fill[\inlinebox@bannerbackcolor] (frame.south west) rectangle node[text = \inlinebox@bannertextcolor, scale = 0.4, font = \sffamily\bfseries, rotate = 90] {\inlinebox@bannertext} ([xshift = \inlinebox@bannerwidth]frame.north west);
        \fi
      \end{tcbclipinterior}%
    }%
  ]{#2}%
}
\makeatother
\newcommand{\inlinetext}[1]{\inlinebox{\mintinline{text}{#1}}}
\newcommand{\inlinepython}[1]{\inlinebox{\mintinline{python}{#1}}}

% 设置标题和作者
\maintitle{CaseBot 智能化 API 手册}
\authorname{张琦}
\abstract{
基于 \inlinetext{ctex} 的一个模板,字体、封面、目录、书签、页眉、页脚等都已经设置好。方便直接使用。
}

\begin{document}
\section{模板说明}
\subsection{这个是二级目录}
\subsubsection{这个是三级目录}
这是一段中文, this is english. \textbf{这是中文粗体}, \textbf{this is bold english}. \emph{这是中文斜体}, \emph{this is italic english}. \texttt{这个是中文等宽字体}, \texttt{this is mono english}. \inlinetext{这是一段代码}, \inlinetext{this is code}.

\inlinepython{print('this is python code')}

行间代码如下所示.%
%
\begin{equation*}
    x^2 + y^2 = z^2\text{.}
\end{equation*}%
%
有编号的行间公式如\cref{eqn:test} 所示.%
%
\begin{equation}
  \label{eqn:test}
  \sum_{i=1}^\infty \frac{1}{i^2} = \frac{\pi}{6}\text{.}
\end{equation}

\lipsum[1-2]

\begin{Definition}
  我就是我, 我不是别人, 别人也不是我.
\end{Definition}

\lipsum[5]

插图如\cref{fig:example of figure} 所示.%
%
\begin{figure}[!htb]
  \centering
  \begin{tikzpicture}
    \node[rectangle, draw, inner sep = 1pt, minimum size = 3cm, align = flush center] {23333}; 
  \end{tikzpicture}
  \caption{插图示例}
  \label{fig:example of figure}
\end{figure}

表格如\cref{tab:example of table} 所示.%
%
\begin{table}[!htb]
  \centering
  \tabulinesep=3pt
  \begin{tabu}to 4cm{X[-1, c]|X[1, l]}
    \tabucline[1pt]{-}
       序号 & 标题  \\
    \tabucline[1pt]{-}
       1 & 锄禾日当午 \\
       2 & 汗滴禾下土 \\
       3 & 谁知盘中餐 \\
       4 & 粒粒皆辛苦 \\
    \tabucline[1pt]{-}
  \end{tabu}
  \caption{表格示例}
  \label{tab:example of table}
\end{table}
\end{document}
